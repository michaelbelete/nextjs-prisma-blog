{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/home/michaelbelete/Documents/Learning/node/nextjs/blog-tutorial/blogr-nextjs-prisma/pages/drafts.tsx\",\n    _s = $RefreshSig$();\n\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport Layout from '../components/Layout';\nimport Post from '../components/Post';\nimport { useSession } from 'next-auth/client';\n\nvar Drafts = function Drafts(props) {\n  _s();\n\n  var _useSession = useSession(),\n      _useSession2 = _slicedToArray(_useSession, 1),\n      session = _useSession2[0];\n\n  if (!session) {\n    return __jsx(Layout, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40,\n        columnNumber: 7\n      }\n    }, __jsx(\"h1\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 9\n      }\n    }, \"My Drafts\"), __jsx(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 9\n      }\n    }, \"You need to be authenticated to view this page.\"));\n  }\n\n  return __jsx(Layout, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    className: \"jsx-1536480903\" + \" \" + \"page\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 7\n    }\n  }, __jsx(\"h1\", {\n    className: \"jsx-1536480903\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 9\n    }\n  }, \"My Drafts\"), __jsx(\"main\", {\n    className: \"jsx-1536480903\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 9\n    }\n  }, props.drafts.map(function (post) {\n    return __jsx(\"div\", {\n      key: post.id,\n      className: \"jsx-1536480903\" + \" \" + \"post\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 13\n      }\n    }, __jsx(Post, {\n      post: post,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 15\n      }\n    }));\n  }))), __jsx(_JSXStyle, {\n    id: \"1536480903\",\n    __self: _this\n  }, \".post.jsx-1536480903{background:var(--geist-background);-webkit-transition:box-shadow 0.1s ease-in;transition:box-shadow 0.1s ease-in;}.post.jsx-1536480903:hover{box-shadow:1px 1px 3px #aaa;}.post.jsx-1536480903+.post.jsx-1536480903{margin-top:2rem;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL21pY2hhZWxiZWxldGUvRG9jdW1lbnRzL0xlYXJuaW5nL25vZGUvbmV4dGpzL2Jsb2ctdHV0b3JpYWwvYmxvZ3ItbmV4dGpzLXByaXNtYS9wYWdlcy9kcmFmdHMudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQTBEa0IsQUFHOEMsQUFLUCxBQUlaLGdCQUNsQixZQUpBLE9BTHFDLDhFQUNyQyIsImZpbGUiOiIvaG9tZS9taWNoYWVsYmVsZXRlL0RvY3VtZW50cy9MZWFybmluZy9ub2RlL25leHRqcy9ibG9nLXR1dG9yaWFsL2Jsb2dyLW5leHRqcy1wcmlzbWEvcGFnZXMvZHJhZnRzLnRzeCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBHZXRTZXJ2ZXJTaWRlUHJvcHMgfSBmcm9tICduZXh0JztcbmltcG9ydCBMYXlvdXQgZnJvbSAnLi4vY29tcG9uZW50cy9MYXlvdXQnO1xuaW1wb3J0IFBvc3QsIHsgUG9zdFByb3BzIH0gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3N0JztcbmltcG9ydCB7IHVzZVNlc3Npb24sIGdldFNlc3Npb24gfSBmcm9tICduZXh0LWF1dGgvY2xpZW50JztcbmltcG9ydCBwcmlzbWEgZnJvbSAnLi4vbGliL3ByaXNtYSc7XG5cbmV4cG9ydCBjb25zdCBnZXRTZXJ2ZXJTaWRlUHJvcHM6IEdldFNlcnZlclNpZGVQcm9wcyA9IGFzeW5jICh7IHJlcSwgcmVzIH0pID0+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb24oeyByZXEgfSk7XG4gIGlmICghc2Vzc2lvbikge1xuICAgIHJlcy5zdGF0dXNDb2RlID0gNDAzO1xuICAgIHJldHVybiB7IHByb3BzOiB7IGRyYWZ0czogW10gfSB9O1xuICB9XG5cbiAgY29uc3QgZHJhZnRzID0gYXdhaXQgcHJpc21hLnBvc3QuZmluZE1hbnkoe1xuICAgIHdoZXJlOiB7XG4gICAgICBhdXRob3I6IHsgZW1haWw6IHNlc3Npb24udXNlci5lbWFpbCB9LFxuICAgICAgcHVibGlzaGVkOiBmYWxzZSxcbiAgICB9LFxuICAgIGluY2x1ZGU6IHtcbiAgICAgIGF1dGhvcjoge1xuICAgICAgICBzZWxlY3Q6IHsgbmFtZTogdHJ1ZSB9LFxuICAgICAgfSxcbiAgICB9LFxuICB9KTtcbiAgcmV0dXJuIHtcbiAgICBwcm9wczogeyBkcmFmdHMgfSxcbiAgfTtcbn07XG5cbnR5cGUgUHJvcHMgPSB7XG4gIGRyYWZ0czogUG9zdFByb3BzW107XG59O1xuXG5jb25zdCBEcmFmdHM6IFJlYWN0LkZDPFByb3BzPiA9IChwcm9wcykgPT4ge1xuICBjb25zdCBbc2Vzc2lvbl0gPSB1c2VTZXNzaW9uKCk7XG5cbiAgaWYgKCFzZXNzaW9uKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxMYXlvdXQ+XG4gICAgICAgIDxoMT5NeSBEcmFmdHM8L2gxPlxuICAgICAgICA8ZGl2PllvdSBuZWVkIHRvIGJlIGF1dGhlbnRpY2F0ZWQgdG8gdmlldyB0aGlzIHBhZ2UuPC9kaXY+XG4gICAgICA8L0xheW91dD5cbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8TGF5b3V0PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJwYWdlXCI+XG4gICAgICAgIDxoMT5NeSBEcmFmdHM8L2gxPlxuICAgICAgICA8bWFpbj5cbiAgICAgICAgICB7cHJvcHMuZHJhZnRzLm1hcCgocG9zdCkgPT4gKFxuICAgICAgICAgICAgPGRpdiBrZXk9e3Bvc3QuaWR9IGNsYXNzTmFtZT1cInBvc3RcIj5cbiAgICAgICAgICAgICAgPFBvc3QgcG9zdD17cG9zdH0gLz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICkpfVxuICAgICAgICA8L21haW4+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxzdHlsZSBqc3g+e2BcbiAgICAgICAgLnBvc3Qge1xuICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWdlaXN0LWJhY2tncm91bmQpO1xuICAgICAgICAgIHRyYW5zaXRpb246IGJveC1zaGFkb3cgMC4xcyBlYXNlLWluO1xuICAgICAgICB9XG5cbiAgICAgICAgLnBvc3Q6aG92ZXIge1xuICAgICAgICAgIGJveC1zaGFkb3c6IDFweCAxcHggM3B4ICNhYWE7XG4gICAgICAgIH1cblxuICAgICAgICAucG9zdCArIC5wb3N0IHtcbiAgICAgICAgICBtYXJnaW4tdG9wOiAycmVtO1xuICAgICAgICB9XG4gICAgICBgfTwvc3R5bGU+XG4gICAgPC9MYXlvdXQ+XG4gICk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBEcmFmdHM7Il19 */\\n/*@ sourceURL=/home/michaelbelete/Documents/Learning/node/nextjs/blog-tutorial/blogr-nextjs-prisma/pages/drafts.tsx */\"));\n};\n\n_s(Drafts, \"Vxy5gMemEU/s8dbgarDyE2/t+kg=\", false, function () {\n  return [useSession];\n});\n\n_c = Drafts;\nexport var __N_SSP = true;\nexport default Drafts;\n\nvar _c;\n\n$RefreshReg$(_c, \"Drafts\");","map":{"version":3,"sources":["/home/michaelbelete/Documents/Learning/node/nextjs/blog-tutorial/blogr-nextjs-prisma/pages/drafts.tsx"],"names":["React","Layout","Post","useSession","Drafts","props","session","drafts","map","post","id"],"mappings":";;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEA,OAAOC,MAAP,MAAmB,sBAAnB;AACA,OAAOC,IAAP,MAAgC,oBAAhC;AACA,SAASC,UAAT,QAAuC,kBAAvC;;AA8BA,IAAMC,MAAuB,GAAG,SAA1BA,MAA0B,CAACC,KAAD,EAAW;AAAA;;AAAA,oBACvBF,UAAU,EADa;AAAA;AAAA,MAClCG,OADkC;;AAGzC,MAAI,CAACA,OAAL,EAAc;AACZ,WACE,MAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yDAFF,CADF;AAMD;;AAED,SACE,MAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA,wCAAe,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGD,KAAK,CAACE,MAAN,CAAaC,GAAb,CAAiB,UAACC,IAAD;AAAA,WAChB;AAAK,MAAA,GAAG,EAAEA,IAAI,CAACC,EAAf;AAAA,0CAA6B,MAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,IAAD;AAAM,MAAA,IAAI,EAAED,IAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADgB;AAAA,GAAjB,CADH,CAFF,CADF;AAAA;AAAA;AAAA,4nGADF;AA4BD,CAxCD;;GAAML,M;UACcD,U;;;KADdC,M;;AA0CN,eAAeA,MAAf","sourcesContent":["import React from 'react';\nimport { GetServerSideProps } from 'next';\nimport Layout from '../components/Layout';\nimport Post, { PostProps } from '../components/Post';\nimport { useSession, getSession } from 'next-auth/client';\nimport prisma from '../lib/prisma';\n\nexport const getServerSideProps: GetServerSideProps = async ({ req, res }) => {\n  const session = await getSession({ req });\n  if (!session) {\n    res.statusCode = 403;\n    return { props: { drafts: [] } };\n  }\n\n  const drafts = await prisma.post.findMany({\n    where: {\n      author: { email: session.user.email },\n      published: false,\n    },\n    include: {\n      author: {\n        select: { name: true },\n      },\n    },\n  });\n  return {\n    props: { drafts },\n  };\n};\n\ntype Props = {\n  drafts: PostProps[];\n};\n\nconst Drafts: React.FC<Props> = (props) => {\n  const [session] = useSession();\n\n  if (!session) {\n    return (\n      <Layout>\n        <h1>My Drafts</h1>\n        <div>You need to be authenticated to view this page.</div>\n      </Layout>\n    );\n  }\n\n  return (\n    <Layout>\n      <div className=\"page\">\n        <h1>My Drafts</h1>\n        <main>\n          {props.drafts.map((post) => (\n            <div key={post.id} className=\"post\">\n              <Post post={post} />\n            </div>\n          ))}\n        </main>\n      </div>\n      <style jsx>{`\n        .post {\n          background: var(--geist-background);\n          transition: box-shadow 0.1s ease-in;\n        }\n\n        .post:hover {\n          box-shadow: 1px 1px 3px #aaa;\n        }\n\n        .post + .post {\n          margin-top: 2rem;\n        }\n      `}</style>\n    </Layout>\n  );\n};\n\nexport default Drafts;"]},"metadata":{},"sourceType":"module"}